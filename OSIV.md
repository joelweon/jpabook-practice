## OSIV(Open Session In View)

JPA 책 - 김영한 (p.593)

OSIV는 영속성 컨텍스트를 뷰까지 열어둔다는 뜻이다.
영속성 컨텍스트가 살아있으면 엔티티는 영속 상태로 유지된다.
따라서 뷰에서도 지연 로딩을 사용 할 수 있다.

> OSIV는 하이버네이트에서 사용하는 용어이다. JPA에서는 OEIV(Open EntityManager In View)라 한다.
하지만 관계상 OSIV라고 부른다.

### 과거 OSIV: 요청 당 트랜잭션(Transaction per request)

- 문제점:
    - 컨트롤러에서 보안상의 이유로 이메일을 xxx@email.com 이라고 변경하고 `setEmail("xxx@email.com")`
    렌더링할 뷰에 넘겼는데 요청 당 트랜잭션 방식의 OSIV는 뷰를 렌더링한 후 드랜잭션을 커밋한다.
    - 서비스 계층처럼 비즈니스 로직을 수행하는 곳에서의 변경은 당연하지만 프리젠테이션 계층에서는
    엔티티 수정이 안되게 막아야한다.
     
- 3가지 해결책:
    1) 엔티티를 읽기 전용 인터페이스로 제공
    2) 엔티티 래핑
    3) DTO만 반환
    
#### 1) 엔티티를 읽기 전용 인터페이스로 제공
이 방법은 엔티티를 직접 노출하는 대신에 읽기 전용 메소드만 제공하는 인터페이스를
프리젠테이션 계층에 제공하는 방법이다.


#### 2) 엔티티 래핑



#### 3) DTO만 반환